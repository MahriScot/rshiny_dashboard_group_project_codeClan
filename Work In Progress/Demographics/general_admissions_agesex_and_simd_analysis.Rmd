---
title: "Demographics analysis 1 - General Admissions"
subtitle: General Admissions
output:
  html_document:
    df_print: paged
---

* **These are general hospital admissions**
* **This data is by QUARTER - 2016Q3 to 2021Q3** 
* **SEX here is "Male", "Female"**
* **AGE groups are in 10 year increments with (from "0-10 to "90 and over")**
* **SIMD (Scottish Index of Multiple Deprivation)**
  * This is a quintile scale (1 = "Most Deprived", 5 = "Least Deprived"). The 
  most appropriate SIMD released for each year is used. REMEMBER: removed 962 
  NAs. There are codes in the simdqf column as to why they are NA - sometimes 
  it's just a general geographical groupings.

* Total per age group 
  * 0-9 years	1261	
  * 10-19 years	1893	
  * 20-29 years	1965	
  * 30-39 years	1990	
  * 40-49 years	2041	
  * 50-59 years	2091	
  * 60-69 years	2114	
  * 70-79 years	2129	
  * 80-89 years	2140	
  * 90 years and over	2007

* Total per sex
  * Female	9832			
  * Male	9799	
  
* Totals per SIMD
  * 1	1042	- "Most Deprived"
  * 2	1066		
  * 3	1080
  * 4	1074	
  * 5	1018

#### Libraries Used 
```{r}
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
```
<br> 

## Read In Cleaned Data

```{r}
acute_activity_agesex <- read_csv(here("../../clean_data/acute_activity_by_board_of_treatment_age_sex_clean.csv"))

acute_activity_simd <- 
  read_csv(here("../../clean_data/acute_activity_by_board_of_treatment_simd_clean.csv"))
```

### Seeing what we're working with:

*Age*
```{r}
acute_activity_agesex %>% 
  group_by(age) %>% 
  count()
# 10 year increments i.e. 0-9, 10-19... 80-89, 90 years and over
# No NA values

acute_activity_agesex %>% 
  mutate(age = is.na(age)) %>% 
  filter(age == TRUE)
```

*Sex*

```{r}
acute_activity_agesex %>% 
  group_by(sex) %>% 
  count()

# Female: 9,832   Male: 9,799 
# No NA values

acute_activity_agesex %>% 
  mutate(sex = is.na(age)) %>% 
  filter(sex == TRUE)
```

**SIMD** 
```{r}
acute_activity_simd %>% 
  group_by(simd) %>% 
  count()
#There were 962 NAs. cleaned in R script. 
```


Remember there were 7 admission types... I chose to keep Emergency Inpatients. 

Others = Elective Inpatients, Transfers, All Day cases, All Inpatients, All 
Inpatients and Day cases, Not Specified

<hr>

<br>

## Graphs

<br>

### Sex and stays

```{r}
acute_activity_agesex %>% 
  ggplot()+
  aes(x = quarter, 
      y = total_stays_per_quarter_sex, 
      group = sex, colour = sex) +
  geom_line() + 
  labs(x = "Yearly Quarter", 
       y = "Total Stays", 
       title = "Total Emergency Inpatient Stays Across Scotland by Sex",
       subtitle = "Q3, 2016 - Q3, 2021", 
       colour = "Sex") +
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=0.9))

```


<br>

## AGE GROUPS AND TOTAL STAYS 

```{r}
acute_activity_agesex %>% 
  ggplot()+
  aes(x = quarter, 
      y = total_stays_per_quarter_age, 
      group = age, colour = age) +
  geom_point()+
  geom_line() + 
  labs(x = "Yearly Quarter", 
       y = "Total Stays", 
       title = "Total Emergency Inpatient Stays Across Scotland by Age Group",
       subtitle = "Q3, 2016 - Q3, 2021", 
       colour = "Age") +
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=0.9))

```

## SIMD - deprivation level data 

<br>

### Total stays per SIMD
```{r}
acute_activity_simd %>%
     mutate(simd = fct_relevel(as.character(simd, 
                                  "1", "2", "3", "4", "5"))) %>%
  ggplot()+
  aes(x = quarter, 
      y = total_stays_per_quarter_simd, 
      group = simd, colour = simd) +
  geom_point()+
  geom_line() + 
  labs(x = "Yearly Quarter", 
       y = "Total Stays", 
       title = "Total Emergency Inpatient Stays Across Scotland by SIMD Level",
       subtitle = "Q3, 2016 - Q3, 2021", 
       colour = "SIMD Level:
       1 = Most Deprived
       5 = Least Deprived") +
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=0.9))

```



## Comparing total EPISODES with stays(above) for SIMD


```{r}
acute_activity_simd %>%
     mutate(simd = fct_relevel(as.character(simd, 
                                  "1", "2", "3", "4", "5"))) %>%
  ggplot()+
  aes(x = quarter, 
      y = total_episodes_per_quarter_simd, 
      group = simd, colour = simd) +
  geom_point()+
  geom_line() + 
  labs(x = "Yearly Quarter", 
       y = "Total Stays", 
       title = "Total Emergency Inpatient Episodes Across Scotland by SIMD Level",
       subtitle = "Q3, 2016 - Q3, 2021", 
       colour = "SIMD Level:
       1 = Most Deprived
       5 = Least Deprived") +
  theme_bw()+
  theme(axis.text.x = element_text(angle=45, hjust=0.9))

```
<hr>
