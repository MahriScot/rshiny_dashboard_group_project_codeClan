---
title: "R Notebook"
output: html_notebook
---
Not using


let's try again to see if there's difference in age groups and seasons:
* Winter = Q4 and Q1 
* Summer = Q2 and Q3
```{r}
highlight_winter_HB_agesex <- covid_admissions_HB_age_totals %>% 
  filter(str_detect(wk_ending_yr_month, 
                    "October|November|December|January|February|March"))

highlight_summer_HB_agesex <- covid_admissions_HB_age_totals %>% 
  filter(str_detect(wk_ending_yr_month, 
                    "April|May|June|July|August|September"))
```


Re-trying above graph -  messy but can be looked into.
* Total COVID admissions per month by age group
```{r}
covid_admissions_HB_AGE %>% 
  mutate(age_group = fct_relevel(age_group, 
                                 "Under 5", "5 - 14", "15 - 44", 
                                 "45 - 64", "65 - 74", "75 - 84", 
                                 "85 and over")) %>%
  ggplot()+
  aes(x = wk_ending_yr_month, 
      y = total_admissions_per_month_age, 
      group = age_group, 
      fill = age_group)+
  scale_x_discrete(limits = dates) +
  geom_col()+
  facet_wrap(~age_group)+
  labs(x = "Month",
       y = "Total admissions",
       title = "HB Total admissions per month by age group",
       subtitle = "January, 2020 - February 2022",
       fill = "Age Group") +
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.9))
```






**THE ABOVE BUT WINTER vs SUMMER**

* Total COVID admissions per month by age group
* SUMMER
```{r}

highlight_summer_HB_agesex %>% 
  mutate(age_group = fct_relevel(age_group, 
                                 "Under 5", "5 - 14", "15 - 44", 
                                 "45 - 64", "65 - 74", "75 - 84", 
                                 "85 and over")) %>%
  ggplot()+
  aes(x = wk_ending_yr_month, 
      y = total_admissions_per_month, 
      group = age_group, 
      fill = age_group)+
  scale_x_discrete(limits = summer_dates) +
  geom_col()+
  facet_wrap(~age_group)+
  labs(x = "Month",
       y = "Total admissions",
       title = "HB Total admissions per month by age group",
       subtitle = "Summer Months: 
       April, 2020 - September 2020 
       and April, 2021 - September 2021",
       fill = "Age Group") +
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.9))
```

* Total COVID admissions per month by age group
* WINTER

```{r}

highlight_winter_HB_agesex %>% 
  mutate(age_group = fct_relevel(age_group, 
                                 "Under 5", "5 - 14", "15 - 44", 
                                 "45 - 64", "65 - 74", "75 - 84", 
                                 "85 and over")) %>%
  ggplot()+
  aes(x = wk_ending_yr_month, 
      y = total_admissions_per_month, 
      group = age_group, 
      fill = age_group)+
  scale_x_discrete(limits = winter_dates) +
  geom_col()+
  facet_wrap(~age_group)+
  labs(x = "Month",
       y = "Total admissions",
       title = "HB Total admissions per month by age group",
       subtitle = "Winter Months: 
       January, 2020 - March 2020; 
       October 2020 - March 2021; 
       October 2021 - February 2022",
       fill = "Age Group") +
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.9))
```







**The above again just looking to see if there are differences in age groups**
* Weekly admissions per age group against the average weekly admissions in 
previous years (2018&19)

```{r}
covid_admissions_HB_AGE %>% 
  mutate(age_group = fct_relevel(age_group, 
                                 "Under 5", "5 - 14", "15 - 44", 
                                 "45 - 64", "65 - 74", "75 - 84", 
                                 "85 and over")) %>% 
  group_by(age_group) %>% 
  ggplot()+
  aes(x = number_admissions, 
      y = average20182019, 
      colour = age_group)+
  geom_point() +
  facet_wrap(~age_group) +
  labs(x = "Weekly number of admissions",
       y = "Average weekly admissions to hospital in 2018-2019",
       title = "HB Weekly admissions per age group against the average weekly 
       admissions in previous years",
       subtitle = "COVID: January, 2020 - February, 2022 / 
       Previous years: 2018 - 2019",
       colour = "Age Group") +
  theme_bw()+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.9))
```